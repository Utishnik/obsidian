Хочу разобрать 
1) как тсс распирсивает скобочные выражения
2) как работает его стек 
3) как устроены атомарки
4) и тд
Я еще не закончил с функциями в частности с inline функциями.
![[Pasted image 20241114181246.png]]
массив с инлаин функциями [[inline_fns]] интересно как будет вести себя тсс при инлаин функции с рекурсиями наверное выдаст ошибку что инлаин функцию нельзя вызывать в ней же.
![[Pasted image 20241114181522.png]]
Место заполнения.
![[Pasted image 20241114181711.png]]
есть еще [[nb_inline_fns]] и в [[inline_fns]] записывается [[nb_inline_fns]].
![[Pasted image 20241114184903.png]]
наверно пока временно прекращу раздумия мне интресно хочу подступится к этой задачи со стороны [[мат анализа]].
![[Pasted image 20241114195545.png]]
Надо разобраться как устроен [[dynarray_add]].
Круто vs code отказывается находить функцию. Нашлась ...
![[Pasted image 20241114201209.png]]
if ((nb & (nb - 1)) == 0) 
![[Pasted image 20241114202557.png]]
не могу найти иницилизацию этой переменной.[[nb_inline_fns]]
![[Pasted image 20241114203112.png]]
Я увидел это и как будто в это условие не возможно попасть
возможно в структурах по умолчанию ноль я не понимаю.![[Pasted image 20241114204249.png]]
Наверное так и я хочу это проверить не компиля проги или прочитать а прочитать в исохндиках tcc.
![[Pasted image 20241114204507.png]]
[[btype.ref->v]]
надо понять что за [[SYM_FIELD]] [[SYM_FIRST_ANOM]] ну и [[SYM_STRUCT]].
![[Pasted image 20241114210729.png]]
Я хотел с ней разобраться [[decl_initializer_alloc]].
Это одно из немногих мест где вызвается [[sym_push]].

![[Pasted image 20241119191155.png]]
они служат как [[comporator]] в [[block]] в [[qsort]].
Щас заметил это
![[Pasted image 20241119191347.png]]
проверка то что функция [[main]]  и то что у нее тип int если не int то варнинг.
![[Pasted image 20241119191644.png]]
Я не понимаю это место почему тут -1 и что тут происходит.А я понял это специально так зачем то.И почему так есть преобразование типа а там нет.
![[Pasted image 20241119193453.png]]
![[Pasted image 20241119193456.png]]
в новых камитах эти компораторы убрали.
![[Pasted image 20241119194829.png]]
Замены [[comporator]] тут уже виден смысл что в одном месте есть преобразование типов а в другом нет из за [[unsigned]] проверка.
Сейчас попытаюсь получить последние комиты.
![[Pasted image 20241119205058.png]]
пофакту просто две функци в одну собрали - оптимизация.
Сейчас пытаясь решать конфликт увидл свой коммент на 762 строки в tccrun что я хотел там в чем то разобраться.
![[Pasted image 20241119205537.png]]![[Pasted image 20241119205538.png]]
чуть чуть уже нету.
![[Pasted image 20241119205953.png]]![[Pasted image 20241119205955.png]]
Интересно...
[[p->r2]]    [[p->r]]   и [[VT_VALMASK]]
![[Pasted image 20241119210436.png]]


Пытаюсь понять значение этого цикла до и после коммита ![[Pasted image 20241119212532.png]]
![[Pasted image 20241119212800.png]]
Нету этой проверки [[p->c.i]]. [[temp_var->location]].
Короче для этого вообщем надо с хранением переменых разобраться и тд.
[[save_reg]] [[gen_opic]] [[gen_cast]] [[vstore]] - основные с этим связанные.
[[Pasted image 20241119205538.png]] ищу где он пропал и на что заменился.
![[Pasted image 20241119214755.png]]
Вот и не где нет удаления вызова этой функции. То есть она не где не юзалась?

![[Pasted image 20241119215304.png]]Надо будет тоже в ней разобраться она изменилась за последние комиты.[[gcase]] Я точно не уверен но тут 8 и мне почему то интуитивно кажется что она связана с кол-во временых локальных переменных это тоже 8.
![[Pasted image 20241119215745.png]]
Кажется бинарный поиск типо при больших 8 [[l2]]=[[len]]/2 и мы отнимаем и так далее мы отнимаем по половине пока не будет больше 8.И  [[base]] += [[l2]] мы сдвигаем на эту же половину.
![[Pasted image 20241119220146.png]]
А тут это и пишется. Щас гляну в старой версии tcc за [[dwarf_read_sleb128]].
Они использовалась причем довольно много в [[rt_printline_dwarf]].И эта функция есть досих пор.СТОП
![[Pasted image 20241119221010.png]]
Эти функции есть и сейчас но единственное отличие в замене long long на int64 и в изменение названия макросов [[DWARF_MAX_128]].
![[Pasted image 20241201171912.png]]
Кажется поиск наименьшего и наибольшего значения.[[nl]] - наименьшее [[pl]] - наибольшее.
ТУДУ
![[Pasted image 20241201173108.png]]
разобраться c [[TOK_IDENT]]
![[Pasted image 20250106000937.png]]
Вернулся я к тсс и вспомнил про этот коммит я же еще так и не понял как они так цикл в цикле до двух оптимизировали.
![[Pasted image 20250119214854.png]]
потихоньку продвигаюсь в понятии [[r2]].
![[Pasted image 20250119230804.png]]
занулятся только один раз.
![[Pasted image 20250119231347.png]]
![[Pasted image 20250120231605.png]]
![[Pasted image 20250121213725.png]]
![[Pasted image 20250121232114.png]]
![[Pasted image 20250326002806.png]]
![[Pasted image 20250326003047.png]]
![[Pasted image 20250326004718.png]]
![[Pasted image 20250326005314.png]]
![[Pasted image 20250326005428.png]]
![[Pasted image 20250326005458.png]]
![[Pasted image 20250326005552.png]]
![[Pasted image 20250622234910.png]]
![[Pasted image 20250622235001.png]]
![[Pasted image 20250623222140.png]]
![[Pasted image 20250623223254.png]]
![[Pasted image 20250623223414.png]]
архитектурно зависимая
